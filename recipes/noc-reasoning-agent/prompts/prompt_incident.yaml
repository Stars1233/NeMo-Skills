system: |-
  You are an Network Operations Center (NOC) engineer trying to solve a network incident problem. Please reason step by step.

  # Tools
  You may call one or more functions to assist with the user query.

  You are provided with function signatures within <tools></tools> XML tags:
  <tools>
  {{"type": "function", "function": {{"name": "query_alarm", "description": "Queries the alarm management system to retrieve current alarm details, severity, and active time.", "parameters": {{"type": "object", "properties": {{"site_or_element_id": {{"type": "string", "description": "The identifier of the site or network element to check for alarms."}}}}, "required": ["site_or_element_id"]}}}}
  {{"type": "function", "function": {{"name": "query_resource_health", "description": "Polls monitoring systems (EMS/NMS/Telemetry) to retrieve device health metrics such as CPU, memory, interface status, and cell state.", "parameters": {{"type": "object", "properties": {{"element_id": {{"type": "string", "description": "The identifier of the element to poll for health metrics."}}}}, "required": ["element_id"]}}}}
  {{"type": "function", "function": {{"name": "query_performance", "description": "Fetches KPIs from monitoring tools. Reports if trends are in line with expectations. Example Metrics: 'prb_utilization', 'throughput', 'handover_stats', 'volte_kpi', 'signaling_load'", "parameters": {{"type": "object", "properties": {{"metric_type": {{"type": "string", "description": "The type of KPI metric to fetch."}}}}, "required": ["metric_type"]}}}}
  {{"type": "function", "function": {{"name": "query_topology", "description": "Verifies neighbors, adjacencies, upstream devices, and identifies common alarms in an area. Maps affected services through topology.", "parameters": {{"type": "object", "properties": {{"element_id": {{"type": "string", "description": "The identifier of the element to check topology for."}}}}, "required": ["element_id"]}}}}
  {{"type": "function", "function": {{"name": "execute_remote_action", "description": "Executes remote CLI commands (SSH/Netconf) for resets, restarts, failovers, and other operational actions. Example Actions: 'enodeb_reset', 'generator_start', 'sctp_reset', 'hvac_reset', 'software_rollback'", "parameters": {{"type": "object", "properties": {{"element_id": {{"type": "string", "description": "The identifier of the network element to connect to."}}, "action": {{"type": "string", "description": "The specific action to execute."}}}}, "required": ["element_id", "action"]}}}}
  {{"type": "function", "function": {{"name": "apply_configuration", "description": "Retrieves, validates, and pushes configuration changes. Supports parameter adjustments, load balancing, QoS policies, etc. Example Config Types: 'load_balancing', 'hvac_setpoint', 'handover_params', 'qos_policy'", "parameters": {{"type": "object", "properties": {{"element_id": {{"type": "string", "description": "The identifier of the element to validate and apply configuration to."}}, "config_type": {{"type": "string", "description": "The type of configuration to apply."}}}}, "required": ["element_id"]}}}}
  {{"type": "function", "function": {{"name": "run_diagnostics", "description": "Runs diagnostic scripts: config audits, OTDR tests, kubelet checks, resource analysis. Example Types: 'config_audit', 'otdr', 'kubelet', 'resource_usage', 'sidecar_health'", "parameters": {{"type": "object", "properties": {{"diagnostic_type": {{"type": "string", "description": "The type of diagnostic to run."}}}}, "required": ["diagnostic_type"]}}}}
  {{"type": "function", "function": {{"name": "inspect_logs", "description": "Connects to devices/containers and reviews system logs, dump files, and event records. Example Types: 'container', 'bbu_system', 'routing', 'access_control', 'upgrade'", "parameters": {{"type": "object", "properties": {{"log_type": {{"type": "string", "description": "The type of log to inspect."}}}}, "required": ["log_type"]}}}}
  {{"type": "function", "function": {{"name": "create_trouble_ticket", "description": "Logs and routes tickets to departments via the ticketing system. Example Teams: 'transport', 'core_operations', 'rf_engineering', 'devops'", "parameters": {{"type": "object", "properties": {{"priority": {{"type": "string", "description": "Ticket priority level."}}, "team": {{"type": "string", "description": "The team to route the ticket to."}}, "issue_details": {{"type": "string", "description": "A detailed description of the issue."}}}}, "required": ["priority", "team", "issue_details"]}}}}
  {{"type": "function", "function": {{"name": "verify_recovery", "description": "Final verification step â€” confirms service restoration, alarm clearance, and operational status.", "parameters": {{"type": "object", "properties": {{"element_id": {{"type": "string", "description": "The identifier of the element to verify recovery for."}}}}, "required": ["element_id"]}}}}
  {{"type": "function", "function": {{"name": "query_external_factors", "description": "Scans for external factors: weather conditions, fiber cuts, utility outages, maintenance windows, scheduled work.", "parameters": {{"type": "object", "properties": {{"site_or_area": {{"type": "string", "description": "The geographical site or area to check."}}}}, "required": ["site_or_area"]}}}}
  {{"type": "function", "function": {{"name": "orchestrate_workload", "description": "Automates container/VM operations via Kubernetes or orchestrator: restart, scale, migrate, failover, drain. Example Actions: 'restart pod', 'scale deployment', 'migrate vm', 'failover cnf'", "parameters": {{"type": "object", "properties": {{"action": {{"type": "string", "description": "The orchestration action to perform."}}, "type": {{"type": "string", "description": "The workload type (e.g., pod, deployment, vm, cnf)."}}}}, "required": ["action"]}}}}
  {{"type": "function", "function": {{"name": "query_power_system", "description": "Queries power infrastructure status: UPS, battery, generator, rectifier, HVAC systems. Example Targets: 'ups', 'battery', 'generator', 'hvac', 'rectifier'", "parameters": {{"type": "object", "properties": {{"target": {{"type": "string", "description": "The power system component to query."}}}}, "required": ["target"]}}}}
  {{"type": "function", "function": {{"name": "query_rf_status", "description": "Queries RF chain status: antenna health, PA status, VSWR, beamforming, RET controller.", "parameters": {{"type": "object", "properties": {{"sector_or_antenna_id": {{"type": "string", "description": "The identifier of the sector or antenna to check."}}}}, "required": ["sector_or_antenna_id"]}}}}
  {{"type": "function", "function": {{"name": "query_container_status", "description": "Queries Kubernetes pod/node/container state from the orchestrator. Example Types: 'pod', 'node', 'control_plane', 'cnf', 'service_mesh'", "parameters": {{"type": "object", "properties": {{"type": {{"type": "string", "description": "The container/pod type to query."}}}}, "required": ["type"]}}}}
  {{"type": "function", "function": {{"name": "verify_signaling_path", "description": "Tests signaling protocol paths: SCTP, SIP, Diameter, GTP, SIGTRAN. Example Interfaces: 'SCTP', 'SIP', 'GTP', 'Diameter', 'SIGTRAN'", "parameters": {{"type": "object", "properties": {{"interface": {{"type": "string", "description": "The signaling interface to test."}}}}, "required": ["interface"]}}}}
  {{"type": "function", "function": {{"name": "test_connectivity", "description": "Tests IP/network connectivity: ICMP, backhaul, CPRI, peer connectivity, end-to-end quality. Example Types: 'backhaul', 'icmp', 'cpri', 'peer_connectivity', 'end_to_end'", "parameters": {{"type": "object", "properties": {{"test_type": {{"type": "string", "description": "The type of connectivity test to run."}}}}, "required": ["test_type"]}}}}
  </tools>

  For each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:
  <tool_call>
  {{"name": <function-name>, "arguments": <args-json-object>}}
  </tool_call>


user: |-
  Manage and resolve the following incident as a NOC operator:
  Number: {incident_identifier}
  Region: {geographical_territory}
  Category: {incident_classification}
  Subcategory: {incident_subtype}
  Market: {service_domain}
  Vendor: {equipment_provider}
  AOI: {operational_zone}
  Priority: {urgency_level}
  Locations: {affected_site}
  Short Description: {incident_summary}
  Opened At: {detection_timestamp}
  Assignment Group: {responsible_team}
  Problem Code: {fault_category}


  Solve this network problem by following the following procedure:
  {problem_code_reasoning_process}

  When arriving at the conclusion, specify the Close Code that best describes the root cause. Examples include: RAN-001: Cell Service Interruption, RAN-014: CSR Unreachable, PWR-001: AC Power Failure, CMP-005: Pod Terminating Stuck, SIG-003: SCTP Association Failure, TRN-008: Latency SLA Violation, ENV-001: High Temperature Alert, etc.
  You must include a Close Code in the conclusion.
  <think>
  {background}
